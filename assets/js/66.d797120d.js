(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{357:function(t,a,s){"use strict";s.r(a);var n=s(4),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"react-事件系统原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#react-事件系统原理"}},[t._v("#")]),t._v(" React 事件系统原理")]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/mkus1HCB1B6sQ4utb5i39w",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mp.weixin.qq.com/s/mkus1HCB1B6sQ4utb5i39w"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("React 合成事件是 React "),a("strong",[t._v("模拟原生 DOM 事件所有能力的一个对象")]),t._v("，它根据 W3C规范来定义合成事件，"),a("strong",[t._v("兼容所有浏览器")]),t._v("，**拥有与浏览器原生事件相同的接口")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/events.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("react官方描述"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("code",[t._v("SyntheticEvent")]),t._v(" 实例将被传递给你的事件处理函数，它是浏览器的原生事件的跨浏览器包装器。除兼容所有浏览器外，它还拥有和浏览器原生事件相同的接口，包括 "),a("code",[t._v("stopPropagation()")]),t._v(" 和 "),a("code",[t._v("preventDefault()")]),t._v("。")]),t._v(" "),a("p",[t._v("分别打印出合成事件对象e和原生对象"),a("code",[t._v("e.nativeEvent")]),a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/ndgH50E7pIpys4zoaW3Wg9AL8QnSXicAVGFIxqh2H3ibKpTpfW2Bj6Z16SicFJiaHFGhdb93n8VLSyczvt1QLccZicg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"图片"}})]),t._v(" "),a("h2",{attrs:{id:"react-事件系统架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#react-事件系统架构"}},[t._v("#")]),t._v(" React 事件系统架构")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/ndgH50E7pIpys4zoaW3Wg9AL8QnSXicAV3o0MetcVpE6lmBSh5D5CyicXFLia3tic4znwY3vcyf8VkpibiayO47qqb6Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"图片"}})]),t._v(" "),a("h2",{attrs:{id:"我们可以将react系统分成注册和执行两部分去理解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#我们可以将react系统分成注册和执行两部分去理解"}},[t._v("#")]),t._v(" 我们可以将react系统分成注册和执行两部分去理解：")]),t._v(" "),a("h3",{attrs:{id:"一、注册"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、注册"}},[t._v("#")]),t._v(" 一、注册：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("enqueuePutListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("inst"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" registrationName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" transaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" 找到document\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" isDocumentFragment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" containerInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" containerInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nodeType "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DOC_FRAGMENT_TYPE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v(" 注册事件，将事件注册到document上\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" doc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" isDocumentFragment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" containerInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" containerInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_ownerDocument"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v(" 存储事件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("放入事务队列中\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listenTo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("registrationName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" doc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("react事件系统内部对事件在不同浏览器上的执行做了兼容因此无需使用者考虑浏览器相关情况：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" eventType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("addEventListener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      将原生事件添加到target这个dom上"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("也就是上边传递的document上\n      这就是只有document这个"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DOM")]),t._v("节点上有原生事件的原因\n      target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eventType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attachEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("attachEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'on'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" eventType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"二、执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、执行"}},[t._v("#")]),t._v(" 二、执行：")]),t._v(" "),a("h4",{attrs:{id:"事件分发dispatchevent-react合成事件的冒泡机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件分发dispatchevent-react合成事件的冒泡机制"}},[t._v("#")]),t._v(" 事件分发dispatchEvent（react合成事件的冒泡机制）")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleTopLevelImpl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("bookKeeping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" 找到事件触发的"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DOM")]),t._v("和React Component\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" nativeEventTarget "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEventTarget")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bookKeeping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nativeEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" targetInst "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ReactDOMComponentTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getClosestInstanceFromNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nativeEventTarget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v(" 执行事件回调前"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("先由当前组件向上遍历它的所有父组件。\n  得到ancestors这个数组，这个数组同时也是冒泡顺序。\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ancestor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" targetInst"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    bookKeeping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ancestors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ancestor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ancestor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ancestor "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findParent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ancestor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ancestor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  这个顺序就是冒泡的顺序"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("并且我们发现不能通过stopPropagation来阻止"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'冒泡'")]),t._v("。\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" bookKeeping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ancestors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    targetInst "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bookKeeping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ancestors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ReactEventListener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_handleTopLevel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bookKeeping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("topLevelType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" targetInst"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bookKeeping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nativeEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEventTarget")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bookKeeping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nativeEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"handletoplevel-构造合成事件并执行-依赖eventpluginhub"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handletoplevel-构造合成事件并执行-依赖eventpluginhub"}},[t._v("#")]),t._v(" handleTopLevel 构造合成事件并执行（依赖EventPluginHub）")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" 初始化时将eventPlugin注册到EventPluginHub中，不同plugin分别构造不同类型的合成事件\n  ReactInjection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EventPluginHub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("injectEventPluginsByName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("不同插件\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v(" 将事件放入事件池：\n   EventPluginHub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("enqueueEvents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("events"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v(" 再处理队列中的事件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("包括之前未处理完的：\n   EventPluginHub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("processEventQueue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"合成事件-原生事件混用demo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#合成事件-原生事件混用demo"}},[t._v("#")]),t._v(" 合成事件-原生事件混用demo")]),t._v(" "),a("p",[t._v("刚接触react的同学，往往在react事件使用时会与原生事件混合（这里并非指责这种混用行为，只是在混用阶段需要区分出react时间系统和js本身事件的执行差异），时常会有事件执行出现不符合预期的情况，这里我们用一个小demo来感受下二者执行的差异;")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/ndgH50E7pIpys4zoaW3Wg9AL8QnSXicAVq07sXgOQsEl4vt1J7qYGt1Xib0EH1FSqrQ0001HiceqOVkAU8k3pCGjQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"图片"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/ndgH50E7pIpys4zoaW3Wg9AL8QnSXicAVVYUvmm1fL6OiaMunKHXexTxzibyJniaLXPjNvwv7xTXHzEETZxoQTc2TA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"图片"}})]),t._v(" "),a("p",[t._v("打印出执行结果：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/ndgH50E7pIpys4zoaW3Wg9AL8QnSXicAVQtqvUNTmUbBwWWrWqAjAV10IkTibJiaunjfdO0cPyjz2FqIZUrKrqF1Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"图片"}})]),t._v(" "),a("h3",{attrs:{id:"由此我们可以了解到如下原生事件、react事件、document上挂载事件执行顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#由此我们可以了解到如下原生事件、react事件、document上挂载事件执行顺序"}},[t._v("#")]),t._v(" 由此我们可以了解到如下原生事件、react事件、document上挂载事件执行顺序：")]),t._v(" "),a("h2",{attrs:{id:"合成事件存在意义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#合成事件存在意义"}},[t._v("#")]),t._v(" 合成事件存在意义")]),t._v(" "),a("h3",{attrs:{id:"_1-统一管理-document"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-统一管理-document"}},[t._v("#")]),t._v(" 1.统一管理（document）")]),t._v(" "),a("p",[t._v("react事件集中在document上集中管理")]),t._v(" "),a("h3",{attrs:{id:"_2-不同浏览器兼容问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-不同浏览器兼容问题"}},[t._v("#")]),t._v(" 2.不同浏览器兼容问题")]),t._v(" "),a("h3",{attrs:{id:"_3-减少事件创建销毁的性能损耗-避免频繁的垃圾回收机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-减少事件创建销毁的性能损耗-避免频繁的垃圾回收机制"}},[t._v("#")]),t._v(" 3.减少事件创建销毁的性能损耗（避免频繁的垃圾回收机制）")]),t._v(" "),a("p",[t._v("react事件队列的存储和取出使用缓解了dom元素注册销毁所消耗的性能")]),t._v(" "),a("h3",{attrs:{id:"_4-利用合成事件的冒泡从document中触发的特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-利用合成事件的冒泡从document中触发的特性"}},[t._v("#")]),t._v(" 4.利用合成事件的冒泡从document中触发的特性")]),t._v(" "),a("h2",{attrs:{id:"合成事件中存在的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#合成事件中存在的问题"}},[t._v("#")]),t._v(" 合成事件中存在的问题")]),t._v(" "),a("h4",{attrs:{id:"_1-原生事件和合成事件混用时原生事件对入react合成事件的影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-原生事件和合成事件混用时原生事件对入react合成事件的影响"}},[t._v("#")]),t._v(" 1.原生事件和合成事件混用时原生事件对入react合成事件的影响")]),t._v(" "),a("ul",[a("li",[t._v("原生事件中禁止冒泡会阻止react合成事件的执行")]),t._v(" "),a("li",[t._v("react合成事件禁止冒泡不会对原生生效")])]),t._v(" "),a("h4",{attrs:{id:"_2-事件池中中事件处理函数全部被调用之后-所有属性都会被置为-null"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-事件池中中事件处理函数全部被调用之后-所有属性都会被置为-null"}},[t._v("#")]),t._v(" 2.事件池中中事件处理函数全部被调用之后，所有属性都会被置为 null")]),t._v(" "),a("p",[a("img",{attrs:{src:"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==",alt:"图片"}}),a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/ndgH50E7pIpys4zoaW3Wg9AL8QnSXicAVL0XZSFqxL0tZZBKmhHHWeic7wwV9ZndLQO0I27H7jrBrcoACEDXRuqQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"图片"}})]),t._v(" "),a("h5",{attrs:{id:"避免方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#避免方法"}},[t._v("#")]),t._v(" 避免方法：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("e.persist()")]),t._v(" //可以阻止事件池清掉取出事件")]),t._v(" "),a("li",[t._v("17版本react会有废弃事件池等更改，此现象也不会存在")])]),t._v(" "),a("h4",{attrs:{id:"_3-不同版本的-react-组件嵌套使用时-e-stoppropagation无法正常工作-两个不同版本的事件系统是独立的-都注册到document时的时间不相同"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-不同版本的-react-组件嵌套使用时-e-stoppropagation无法正常工作-两个不同版本的事件系统是独立的-都注册到document时的时间不相同"}},[t._v("#")]),t._v(" 3.不同版本的 React 组件嵌套使用时，e.stopPropagation无法正常工作（两个不同版本的事件系统是独立的，都注册到document时的时间不相同）")])])}),[],!1,null,null,null);a.default=e.exports}}]);