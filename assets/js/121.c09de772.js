(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{414:function(t,e,a){"use strict";a.r(e);var r=a(4),s=Object(r.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("ç»è¿‡äº”ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬ç»ˆäºå›åˆ°äº†"),e("code",[t._v("React")]),t._v("åº”ç”¨çš„èµ·ç‚¹ã€‚")]),t._v(" "),e("p",[t._v("è¿™ä¸€èŠ‚æˆ‘ä»¬å®Œæ•´çš„èµ°é€š"),e("code",[t._v("ReactDOM.render")]),t._v("å®Œæˆé¡µé¢æ¸²æŸ“çš„æ•´ä¸ªæµç¨‹ã€‚")]),t._v(" "),e("h2",{attrs:{id:"åˆ›å»ºfiber"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºfiber"}},[t._v("#")]),t._v(" åˆ›å»ºfiber")]),t._v(" "),e("p",[t._v("ä»"),e("RouterLink",{attrs:{to:"/source-code/process/doubleBuffer.html#mountæ—¶"}},[t._v("åŒç¼“å­˜æœºåˆ¶ä¸€èŠ‚")]),t._v("æˆ‘ä»¬çŸ¥é“ï¼Œé¦–æ¬¡æ‰§è¡Œ"),e("code",[t._v("ReactDOM.render")]),t._v("ä¼šåˆ›å»º"),e("code",[t._v("fiberRootNode")]),t._v("å’Œ"),e("code",[t._v("rootFiber")]),t._v("ã€‚å…¶ä¸­"),e("code",[t._v("fiberRootNode")]),t._v("æ˜¯æ•´ä¸ªåº”ç”¨çš„æ ¹èŠ‚ç‚¹ï¼Œ"),e("code",[t._v("rootFiber")]),t._v("æ˜¯è¦æ¸²æŸ“ç»„ä»¶æ‰€åœ¨ç»„ä»¶æ ‘çš„"),e("code",[t._v("æ ¹èŠ‚ç‚¹")]),t._v("ã€‚")],1),t._v(" "),e("p",[t._v("è¿™ä¸€æ­¥å‘ç”Ÿåœ¨è°ƒç”¨"),e("code",[t._v("ReactDOM.render")]),t._v("åè¿›å…¥çš„"),e("code",[t._v("legacyRenderSubtreeIntoContainer")]),t._v("æ–¹æ³•ä¸­ã€‚")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// containeræŒ‡ReactDOM.renderçš„ç¬¬äºŒä¸ªå‚æ•°ï¼ˆå³åº”ç”¨æŒ‚è½½çš„DOMèŠ‚ç‚¹ï¼‰")]),t._v("\nroot "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" container"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_reactRootContainer "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("legacyCreateRootFromDOMContainer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  container"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  forceHydrate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nfiberRoot "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_internalRoot"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("blockquote",[e("p",[t._v("ä½ å¯ä»¥ä»"),e("a",{attrs:{href:"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-dom/src/client/ReactDOMLegacy.js#L193",target:"_blank",rel:"noopener noreferrer"}},[t._v("è¿™é‡Œ"),e("OutboundLink")],1),t._v("çœ‹åˆ°è¿™ä¸€æ­¥çš„ä»£ç ")])]),t._v(" "),e("p",[e("code",[t._v("legacyCreateRootFromDOMContainer")]),t._v("æ–¹æ³•å†…éƒ¨ä¼šè°ƒç”¨"),e("code",[t._v("createFiberRoot")]),t._v("æ–¹æ³•å®Œæˆ"),e("code",[t._v("fiberRootNode")]),t._v("å’Œ"),e("code",[t._v("rootFiber")]),t._v("çš„åˆ›å»ºä»¥åŠå…³è”ã€‚å¹¶åˆå§‹åŒ–"),e("code",[t._v("updateQueue")]),t._v("ã€‚")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createFiberRoot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter"}},[e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("containerInfo")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" RootTag"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("hydrate")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("hydrationCallbacks")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" SuspenseHydrationCallbacks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" FiberRoot "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºfiberRootNode")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("root")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" FiberRoot "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FiberRootNode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("containerInfo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tag"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hydrate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºrootFiber")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" uninitializedFiber "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createHostRootFiber")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tag"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿æ¥rootFiberä¸fiberRootNode")]),t._v("\n  root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" uninitializedFiber"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  uninitializedFiber"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stateNode "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆå§‹åŒ–updateQueue")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("initializeUpdateQueue")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uninitializedFiber"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("æ ¹æ®ä»¥ä¸Šä»£ç ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨"),e("RouterLink",{attrs:{to:"/source-code/process/doubleBuffer.html#mountæ—¶"}},[t._v("åŒç¼“å­˜æœºåˆ¶ä¸€èŠ‚")]),t._v("åŸºç¡€ä¸Šè¡¥å……ä¸Š"),e("code",[t._v("rootFiber")]),t._v("åˆ°"),e("code",[t._v("fiberRootNode")]),t._v("çš„å¼•ç”¨ã€‚")],1),t._v(" "),e("img",{attrs:{src:t.$withBase("/img/fiberroot.png"),alt:"fiberRoot"}}),t._v(" "),e("blockquote",[e("p",[t._v("ä½ å¯ä»¥ä»"),e("a",{attrs:{href:"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberRoot.new.js#L97",target:"_blank",rel:"noopener noreferrer"}},[t._v("è¿™é‡Œ"),e("OutboundLink")],1),t._v("çœ‹åˆ°è¿™ä¸€æ­¥çš„ä»£ç ")])]),t._v(" "),e("h2",{attrs:{id:"åˆ›å»ºupdate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºupdate"}},[t._v("#")]),t._v(" åˆ›å»ºupdate")]),t._v(" "),e("p",[t._v("æˆ‘ä»¬å·²ç»åšå¥½äº†ç»„ä»¶çš„åˆå§‹åŒ–å·¥ä½œï¼Œæ¥ä¸‹æ¥å°±ç­‰å¾…åˆ›å»º"),e("code",[t._v("Update")]),t._v("æ¥å¼€å¯ä¸€æ¬¡æ›´æ–°ã€‚")]),t._v(" "),e("p",[t._v("è¿™ä¸€æ­¥å‘ç”Ÿåœ¨"),e("code",[t._v("updateContainer")]),t._v("æ–¹æ³•ä¸­ã€‚")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateContainer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter"}},[e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("element")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ReactNodeList"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("container")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" OpaqueRoot"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("parentComponent")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("React$Component"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("any"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" any"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("callback")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("Function"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Lane "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...çœç•¥ä¸é€»è¾‘ä¸ç›¸å…³ä»£ç ")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºupdate")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" update "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createUpdate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eventTime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lane"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" suspenseConfig"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// update.payloadä¸ºéœ€è¦æŒ‚è½½åœ¨æ ¹èŠ‚ç‚¹çš„ç»„ä»¶")]),t._v("\n  update"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("payload "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("element"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// callbackä¸ºReactDOM.renderçš„ç¬¬ä¸‰ä¸ªå‚æ•° â€”â€” å›è°ƒå‡½æ•°")]),t._v("\n  callback "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callback "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" callback"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    update"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("callback "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" callback"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°†ç”Ÿæˆçš„updateåŠ å…¥updateQueue")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("enqueueUpdate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("current"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" update"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è°ƒåº¦æ›´æ–°")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("scheduleUpdateOnFiber")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("current"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lane"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" eventTime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...çœç•¥ä¸é€»è¾‘ä¸ç›¸å…³ä»£ç ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("blockquote",[e("p",[t._v("ä½ å¯ä»¥ä»"),e("a",{attrs:{href:"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberReconciler.new.js#L255",target:"_blank",rel:"noopener noreferrer"}},[t._v("è¿™é‡Œ"),e("OutboundLink")],1),t._v("çœ‹åˆ°"),e("code",[t._v("updateContainer")]),t._v("çš„ä»£ç ")])]),t._v(" "),e("p",[t._v("å€¼å¾—æ³¨æ„çš„æ˜¯å…¶ä¸­"),e("code",[t._v("update.payload = {element};")])]),t._v(" "),e("p",[t._v("è¿™å°±æ˜¯æˆ‘ä»¬åœ¨"),e("RouterLink",{attrs:{to:"/source-code/å®ç°-çŠ¶æ€æ›´æ–°/update.html#updateçš„ç»“æ„"}},[t._v("Updateä¸€èŠ‚")]),t._v("ä»‹ç»çš„ï¼Œå¯¹äº"),e("code",[t._v("HostRoot")]),t._v("ï¼Œ"),e("code",[t._v("payload")]),t._v("ä¸º"),e("code",[t._v("ReactDOM.render")]),t._v("çš„ç¬¬ä¸€ä¸ªä¼ å‚ã€‚")],1),t._v(" "),e("h2",{attrs:{id:"æµç¨‹æ¦‚è§ˆ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æµç¨‹æ¦‚è§ˆ"}},[t._v("#")]),t._v(" æµç¨‹æ¦‚è§ˆ")]),t._v(" "),e("p",[t._v("è‡³æ­¤ï¼Œ"),e("code",[t._v("ReactDOM.render")]),t._v("çš„æµç¨‹å°±å’Œæˆ‘ä»¬å·²çŸ¥çš„æµç¨‹è¿æ¥ä¸Šäº†ã€‚")]),t._v(" "),e("p",[t._v("æ•´ä¸ªæµç¨‹å¦‚ä¸‹ï¼š")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("åˆ›å»ºfiberRootNodeã€rootFiberã€updateQueueï¼ˆ"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("legacyCreateRootFromDOMContainer"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("ï¼‰\n\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("v")]),t._v("\n\nåˆ›å»ºUpdateå¯¹è±¡ï¼ˆ"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("updateContainer"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("ï¼‰\n\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("v")]),t._v("\n\nä»fiberåˆ°rootï¼ˆ"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("markUpdateLaneFromFiberToRoot"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("ï¼‰\n\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("v")]),t._v("\n\nè°ƒåº¦æ›´æ–°ï¼ˆ"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("ensureRootIsScheduled"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("ï¼‰\n\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("v")]),t._v("\n\nrenderé˜¶æ®µï¼ˆ"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("performSyncWorkOnRoot"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v(" æˆ– "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("performConcurrentWorkOnRoot"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("ï¼‰\n\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("v")]),t._v("\n\ncommité˜¶æ®µï¼ˆ"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("commitRoot"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("ï¼‰\n")])])]),e("h2",{attrs:{id:"reactçš„å…¶ä»–å…¥å£å‡½æ•°"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#reactçš„å…¶ä»–å…¥å£å‡½æ•°"}},[t._v("#")]),t._v(" Reactçš„å…¶ä»–å…¥å£å‡½æ•°")]),t._v(" "),e("p",[t._v("å½“å‰"),e("code",[t._v("React")]),t._v("å…±æœ‰ä¸‰ç§æ¨¡å¼ï¼š")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("legacy")]),t._v("ï¼Œè¿™æ˜¯å½“å‰"),e("code",[t._v("React")]),t._v("ä½¿ç”¨çš„æ–¹å¼ã€‚å½“å‰æ²¡æœ‰è®¡åˆ’åˆ é™¤æœ¬æ¨¡å¼ï¼Œä½†æ˜¯è¿™ä¸ªæ¨¡å¼å¯èƒ½ä¸æ”¯æŒä¸€äº›æ–°åŠŸèƒ½ã€‚")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("blocking")]),t._v("ï¼Œå¼€å¯éƒ¨åˆ†"),e("code",[t._v("concurrent")]),t._v("æ¨¡å¼ç‰¹æ€§çš„ä¸­é—´æ¨¡å¼ã€‚ç›®å‰æ­£åœ¨å®éªŒä¸­ã€‚ä½œä¸ºè¿ç§»åˆ°"),e("code",[t._v("concurrent")]),t._v("æ¨¡å¼çš„ç¬¬ä¸€ä¸ªæ­¥éª¤ã€‚")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("concurrent")]),t._v("ï¼Œé¢å‘æœªæ¥çš„å¼€å‘æ¨¡å¼ã€‚æˆ‘ä»¬ä¹‹å‰è®²çš„"),e("code",[t._v("ä»»åŠ¡ä¸­æ–­/ä»»åŠ¡ä¼˜å…ˆçº§")]),t._v("éƒ½æ˜¯é’ˆå¯¹"),e("code",[t._v("concurrent")]),t._v("æ¨¡å¼ã€‚")])])]),t._v(" "),e("p",[t._v("ä½ å¯ä»¥ä»ä¸‹è¡¨çœ‹å‡ºå„ç§æ¨¡å¼å¯¹ç‰¹æ€§çš„æ”¯æŒï¼š")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th"),t._v(" "),e("th",[t._v("legacy æ¨¡å¼")]),t._v(" "),e("th",[t._v("blocking æ¨¡å¼")]),t._v(" "),e("th",[t._v("concurrent æ¨¡å¼")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/refs-and-the-dom.html#legacy-api-string-refs",target:"_blank",rel:"noopener noreferrer"}},[t._v("String Refs"),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("âœ…")]),t._v(" "),e("td",[t._v("ğŸš«**")]),t._v(" "),e("td",[t._v("ğŸš«**")])]),t._v(" "),e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/legacy-context.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Legacy Context"),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("âœ…")]),t._v(" "),e("td",[t._v("ğŸš«**")]),t._v(" "),e("td",[t._v("ğŸš«**")])]),t._v(" "),e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/strict-mode.html#warning-about-deprecated-finddomnode-usage",target:"_blank",rel:"noopener noreferrer"}},[t._v("findDOMNode"),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("âœ…")]),t._v(" "),e("td",[t._v("ğŸš«**")]),t._v(" "),e("td",[t._v("ğŸš«**")])]),t._v(" "),e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/concurrent-mode-suspense.html#what-is-suspense-exactly",target:"_blank",rel:"noopener noreferrer"}},[t._v("Suspense"),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("âœ…")]),t._v(" "),e("td",[t._v("âœ…")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/concurrent-mode-patterns.html#suspenselist",target:"_blank",rel:"noopener noreferrer"}},[t._v("SuspenseList"),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[t._v("Suspense SSR + Hydration")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[t._v("Progressive Hydration")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[t._v("Selective Hydration")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[t._v("Cooperative Multitasking")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[t._v("Automatic batching of multiple setStates")]),t._v(" "),e("td",[t._v("ğŸš«*")]),t._v(" "),e("td",[t._v("âœ…")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/concurrent-mode-patterns.html#splitting-high-and-low-priority-state",target:"_blank",rel:"noopener noreferrer"}},[t._v("Priority-based Rendering"),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/concurrent-mode-intro.html#interruptible-rendering",target:"_blank",rel:"noopener noreferrer"}},[t._v("Interruptible Prerendering"),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/concurrent-mode-patterns.html#transitions",target:"_blank",rel:"noopener noreferrer"}},[t._v("useTransition"),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/concurrent-mode-patterns.html#deferring-a-value",target:"_blank",rel:"noopener noreferrer"}},[t._v("useDeferredValue"),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")])]),t._v(" "),e("tr",[e("td",[e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/concurrent-mode-patterns.html#suspense-reveal-train",target:"_blank",rel:"noopener noreferrer"}},[t._v('Suspense Reveal "Train"'),e("OutboundLink")],1)]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("ğŸš«")]),t._v(" "),e("td",[t._v("âœ…")])])])]),t._v(" "),e("p",[t._v("*ï¼š"),e("code",[t._v("legacy")]),t._v("æ¨¡å¼åœ¨åˆæˆäº‹ä»¶ä¸­æœ‰è‡ªåŠ¨æ‰¹å¤„ç†çš„åŠŸèƒ½ï¼Œä½†ä»…é™äºä¸€ä¸ªæµè§ˆå™¨ä»»åŠ¡ã€‚é"),e("code",[t._v("React")]),t._v("äº‹ä»¶æƒ³ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½å¿…é¡»ä½¿ç”¨ "),e("code",[t._v("unstable_batchedUpdates")]),t._v("ã€‚åœ¨"),e("code",[t._v("blocking")]),t._v("æ¨¡å¼å’Œ"),e("code",[t._v("concurrent")]),t._v("æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„"),e("code",[t._v("setState")]),t._v("åœ¨é»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯æ‰¹å¤„ç†çš„ã€‚")]),t._v(" "),e("p",[t._v("**ï¼šä¼šåœ¨å¼€å‘ä¸­å‘å‡ºè­¦å‘Šã€‚")]),t._v(" "),e("p",[t._v("æ¨¡å¼çš„å˜åŒ–å½±å“æ•´ä¸ªåº”ç”¨çš„å·¥ä½œæ–¹å¼ï¼Œæ‰€ä»¥æ— æ³•åªé’ˆå¯¹æŸä¸ªç»„ä»¶å¼€å¯ä¸åŒæ¨¡å¼ã€‚")]),t._v(" "),e("p",[t._v("åŸºäºæ­¤åŸå› ï¼Œå¯ä»¥é€šè¿‡ä¸åŒçš„"),e("code",[t._v("å…¥å£å‡½æ•°")]),t._v("å¼€å¯ä¸åŒæ¨¡å¼ï¼š")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("legacy")]),t._v(" -- "),e("code",[t._v("ReactDOM.render(<App />, rootNode)")])]),t._v(" "),e("li",[e("code",[t._v("blocking")]),t._v(" -- "),e("code",[t._v("ReactDOM.createBlockingRoot(rootNode).render(<App />)")])]),t._v(" "),e("li",[e("code",[t._v("concurrent")]),t._v(" -- "),e("code",[t._v("ReactDOM.createRoot(rootNode).render(<App />)")])])]),t._v(" "),e("blockquote",[e("p",[t._v("ä½ å¯ä»¥åœ¨"),e("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/concurrent-mode-adoption.html#why-so-many-modes",target:"_blank",rel:"noopener noreferrer"}},[t._v("è¿™é‡Œ"),e("OutboundLink")],1),t._v("çœ‹åˆ°"),e("code",[t._v("React")]),t._v("å›¢é˜Ÿè§£é‡Šä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¤šæ¨¡å¼")])]),t._v(" "),e("p",[t._v("è™½ç„¶ä¸åŒæ¨¡å¼çš„"),e("code",[t._v("å…¥å£å‡½æ•°")]),t._v("ä¸åŒï¼Œä½†æ˜¯ä»–ä»¬ä»…å¯¹"),e("code",[t._v("fiber.mode")]),t._v("å˜é‡äº§ç”Ÿå½±å“ï¼Œå¯¹æˆ‘ä»¬åœ¨"),e("RouterLink",{attrs:{to:"/source-code/å®ç°-çŠ¶æ€æ›´æ–°/reactdom.html#æµç¨‹æ¦‚è§ˆ"}},[t._v("æµç¨‹æ¦‚è§ˆ")]),t._v("ä¸­æè¿°çš„æµç¨‹å¹¶æ— å½±å“ã€‚")],1)])}),[],!1,null,null,null);e.default=s.exports}}]);